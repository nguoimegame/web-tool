---
import BaseHashPage from '../../../components/BaseHashPage.astro';
import InputEncodingSelect from '../../../components/InputEncodingSelect.astro';
import OutputEncodingSelect from '../../../components/OutputEncodingSelect.astro';
import { languages } from '../../../i18n/ui';
import { useTranslations } from '../../../i18n/utils';

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => {
    return { params: { lang } };
  });
}

const { lang = 'en' } = Astro.params;
const t = useTranslations(lang as any);
const title = t('shake256.title');
const description = t('shake256.description');
const activePage = 'hash/shake256';
---

<BaseHashPage title={title} description={description} activePage={activePage}>
  <div class="setting">
    <label for="input-type">{t('input_encoding')}</label>
    <InputEncodingSelect id="input-type" dataShare="input_type" dataAutoUpdate={true} />
  </div>
  <div class="setting">
    <label for="output-type">{t('output_encoding')}</label>
    <OutputEncodingSelect id="output-type" dataShare="output_type" dataAutoUpdate={true} />
  </div>
  <div class="setting">
    <label for="bits">{t('bits')}</label>
    <input
      type="number"
      id="bits"
      data-option="bits"
      data-remember="bits-512"
      data-share="bits"
      value="512"
      step="8"
      min="8"
    />
  </div>

  <script is:inline>
    ++waitLoadCount;
    delayScripts.push({
      src: 'https://cdnjs.cloudflare.com/ajax/libs/js-sha3/0.9.3/sha3.min.js',
      onload: function () {
        window.method = withOptions(shake_256, ['bits']);
        methodLoad();
      },
    });
  </script>

  <script is:inline>
    // Encoding script already increments waitLoadCount internally
    delayScripts.push({
      src: '/js/encoding.js?v=8',
    });
  </script>
</BaseHashPage>
